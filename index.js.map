{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst keyAPI =  \"52733365-810bb5faaf6ec9d90304400a7\";\n\nexport let per_page = 15;\n\nexport async function getImagesByQuery(query, page) {\n\n    const searchParams = new URLSearchParams({\n        key: keyAPI,\n        q: query,\n        page: page,\n        per_page: per_page,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\"\n    });\n    \n    try {\n        let response = await axios.get(`https://pixabay.com/api/?${searchParams}`);\n        return response.data;\n    } catch(error) {\n        iziToast.info({\n            position: 'topRight',\n            message: error.message,\n        });\n        return {hits: [],\n                totalHits: 0,\n            };\n    }\n    \n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\n\nlet lightbox;\nlet loader = document.querySelector(\".loader\");\n\n\nlet divButton = document.querySelector(\".div-for-button\");\n\nconst gallery = document.querySelector('.gallery');\n\nexport function createGallery(images) {\n\n    let markUp = images.map(image => { \n        return `<li>\n\n            <div class=\"container-image\">\n                <a href=\"${image.largeImageURL}\">\n                    <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n                </a>\n            </div>\n\n            <div class=\"container-description\">\n                <ul class=\"image-description\">\n                    <li> <span>Likes</span> <span>${image.likes}</span> </li>\n                    <li> <span>Views</span> <span>${image.views}</span> </li>\n                    <li> <span>Comments</span> <span>${image.comments}</span> </li>\n                    <li><span>Downloads</span> <span>${image.downloads}</span> </li>\n                </ul>\n            </div>\n\n        </li>`;\n    }).join(\"\");\n\n    gallery.insertAdjacentHTML('beforeend', markUp);\n\n    if(lightbox) {\n        lightbox.refresh();\n    } else {\n        lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n    }\n}\n\nexport function clearGallery() {\n    gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n    if (loader) loader.style.display = \"block\";\n}\n\nexport function hideLoader() {\n    if (loader) loader.style.display = \"none\";\n}\n\nexport function showLoadMoreButton() {\n    divButton.style.display = \"block\";\n}\n\nexport function hideLoadMoreButton() {\n    divButton.style.display = \"none\"\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport {getImagesByQuery, per_page} from \"./js/pixabay-api.js\";\nimport {createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton} from \"./js/render-functions.js\";\n\n\nlet form = document.querySelector(\".form\");\nlet loadButton = document.querySelector(\".load-button\");\n\nlet query;\n\nlet page;\nlet totalPages;\n\nlet galleryItem;\nlet rect;\n\nform.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    clearGallery();\n    hideLoadMoreButton();\n\n    let userQuery = event.target.elements[\"search-text\"].value.trim();\n    if(userQuery === \"\") {\n        iziToast.error({\n            position: 'topRight',\n            message: 'The field must not be empty',\n        });\n        form.reset();\n        return;\n    }\n\n    showLoader();\n    query = userQuery.split(\" \").join(\"+\");\n\n    page = 1;\n    try {\n        let data = await getImagesByQuery(query, page);\n\n        if(data.hits.length === 0) {\n            iziToast.error({\n                position: 'topRight',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n            return;\n        }\n\n        createGallery(data.hits);\n        galleryItem = document.querySelector(\".gallery\").lastElementChild;\n        rect = galleryItem.getBoundingClientRect().height;\n\n        totalPages = Math.ceil(data.totalHits / per_page);\n\n        if(page >= totalPages){\n            iziToast.info({\n                position: 'topRight',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n\n            hideLoadMoreButton();\n        } else {\n            showLoadMoreButton();\n            //page++;\n        }\n\n    } catch(error) {\n        iziToast.info({\n            position: 'topRight',\n            message: error.message,\n        });\n    } finally {\n        hideLoader();\n    }\n  \n});\n\nloadButton.addEventListener(\"click\", async () => {\n    hideLoadMoreButton();\n    showLoader();\n\n    page++;\n    try {\n        let data = await getImagesByQuery(query, page);\n\n        createGallery(data.hits);\n\n        galleryItem = document.querySelector(\".gallery\").lastElementChild;\n        rect = galleryItem.getBoundingClientRect().height;\n        \n        window.scrollBy({\n            top: rect * 2,\n            behavior: \"smooth\",\n        });\n\n        if(page >= totalPages){\n            iziToast.info({\n                position: 'topRight',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        } else {\n            //page++;\n            showLoadMoreButton();\n        }\n    \n    } catch(error) {\n        iziToast.info({\n            position: 'topRight',\n            message: error.message,\n        });\n    } finally {\n        hideLoader();\n    }\n});"],"names":["keyAPI","per_page","getImagesByQuery","query","page","searchParams","axios","error","iziToast","lightbox","loader","divButton","gallery","createGallery","images","markUp","image","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","loadButton","totalPages","galleryItem","rect","event","userQuery","data"],"mappings":"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"}